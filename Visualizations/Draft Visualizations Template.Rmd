---
title: "Draft Visualizations for Semester Project"
output: word_document
---

#Loading the Data and Necessary Packages
```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
health <- read.csv("mentalsurvey_clean.csv")
```

#Section 1: Showing that Mental and Behavioral Health Issues Impact Workers

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Section 2: What are Other Companies Doing to Assist workers with Mental and Behavioral Health Policies

```{r}

```

#Section 3: What are Factors that Might Limit the Impact of Behavioral Health Outreach

##Anonymity Policies 

If employees feel that their anonymity is not protected, they may be less likely to reach out for help.

###Anonymity Policies by Company Size

####Crosstab Table

```{r}
#Put company size in order
health$CompanySize  = factor(health$How.many.employees.does.your.company.or.organization.have, levels=c("1-5", "6-25", "26-100", "100-500", "500-1000", "More than 1000"))
#Create Cross-tab Table
APbCS <- table(health$Is.your.anonymity.protected.if.you.choose.to.take.advantage.of.mental.health.or.substance.abuse.treatment.resources.provided.by.your.employer., health$CompanySize)
head(APbCS)
```

####Proportions table

```{r}
#Create a proportions table by Row
prop.table(APbCS, 2)
```

####Chi-Squared Test 

```{r}
#Do a chi-squared test
chisq.test(APbCS)
```

We get a warning that the approximation may be incorrect, likely because some of the values from the table are small. Therefore, we cannot draw and conclusions for this test about whether these two variables are related.

####Visualization of Data

```{r}
t0 <- ggplot(health, aes(x = health$Is.your.anonymity.protected.if.you.choose.to.take.advantage.of.mental.health.or.substance.abuse.treatment.resources.provided.by.your.employer.))+geom_bar()+facet_wrap(~health$CompanySize, scales="free_y") + ggtitle("Perceived Difficulty of Asking for Leave by Gender") + xlab("Perceived Difficulty Level") + ylab("Count") 
t0
```

####Interpretation of Results 

The table and chart above show that across all company sizes, most respondents indicate that they do not know what their current company's anonymity policy is towards those using mental health services.  For companies of 1-5 employees, the next most common answer is "No" (anonymity is not protected). However, for companies larger than 5 employees, the results appear fairly consistent, with the majority of respondents (60-70 percent) indicating that they do not know anonymity policies, a sizable minority of respondents saying that anonymity is protected (25-32 percent), and less than 10 percent of respondents in each group saying anonymity is not protected. Based off of the chi-squared test, it is not clear if there is a statistically significant difference in anonymity policies of companies of different sizes. However, the fact that the majority of respondents across company sizes do not know their company's anonymity policy is something that has to be addressed in any outreach program, as a study by Milne, et al (1994) has found that participants tended to be more confident in a company's Employee Assistance Program if they felt it was confidential (p. 141). Therefore, any outreach must make the company's anonymity policy clear. 

###Anonymity Policies by Whether it is a Tech Company

####Cross-tab Table

```{r}
#Add labels to tech company org
health$TLabel <- factor(health$Is.your.employer.primarily.a.tech.company.organization.,
levels = c(0, 1),
labels = c("Not primarily tech", "Primarily Tech"))
```

```{r}
#Create a crosstab table
APbT2 <- table(health$Is.your.anonymity.protected.if.you.choose.to.take.advantage.of.mental.health.or.substance.abuse.treatment.resources.provided.by.your.employer., health$TLabel)
head(APbT2)
```


####Proportions table

```{r}
#Create a proportions table by Row
prop.table(APbT2, 2)
```

####Chi-Squared Test 

This chi-squared test's p value is very large. Therefore, there is likelt not a relationship between these two variables.  

```{r}
#Do a chi-squared test
chisq.test(APbT2)
```

####Visualization of Data

```{r}
#Create Visualization
t1 <- ggplot(health, aes(x = health$Is.your.anonymity.protected.if.you.choose.to.take.advantage.of.mental.health.or.substance.abuse.treatment.resources.provided.by.your.employer.))+geom_bar()+facet_wrap(health$TLabel ~ ., scales="free_y") + ggtitle("Anonymity Protections For Tech vs. Non-Tech Companies") + xlab("Is your anonymity protected?") + ylab("Count") 
t1
```

####Interpretation of Results 

The difference between primarily tech and non-primarily tech companies is not statistically significant in regards to anonymity policies for those seeking mental health services.  However, this may be influenced by the fact that the majority of those surveyed work for primiarily tech-oriented companies, so we do not have a large sample of those working for non-tech companies.  Furthermore, we do not know the industry that these non-tech companies are in, which means we cannot draw any firm conclusions here.  Nevertheless, in both cases, the clear majority of those surveyed indicated that they do not know  their current company's anonymity policy is towards those using mental health services.  In both cases, the next most common response to the question is that anonymity is protected for those using mental health services. As described above, the fact the majority of respondents do not know their company's anonymity policy is something that has to be addressed. 

##Ease of Asking for Leave For A Mental Health Issue

This is important because if employees feel that asking for time off from work for medical leave, they may be less likely to seek the help they need. 

###Answers by Gender

```{r}
#Modify Labels (ideal if we can get it to fit)
health$pd2 <- factor(health$If.a.mental.health.issue.prompted.you.to.request.a.medical.leave.from.work..asking.for.that.leave.would.be.,
levels = c("Very easy", "Somewhat easy", "Neither easy nor difficult","Somewhat difficult", "Very difficult", "I don't know"),
labels = c("Very easy (VE)", "Somewhat Easy (SE)", "Neutral (N)", "Somewhat Hard (SH)", "Very Hard (VH)", "Don't Know (DK)"))
#Modify Labels (if health$pd2 does not fit, use this as an alternate)
health$pd3 <- factor(health$If.a.mental.health.issue.prompted.you.to.request.a.medical.leave.from.work..asking.for.that.leave.would.be.,
levels = c("Very easy", "Somewhat easy", "Neither easy nor difficult","Somewhat difficult", "Very difficult", "I don't know"),
labels = c("VE", "SE", "N", "SH", "VH", "DK"))
```

```{r}
#Crosstab table
ELDbG <- table(health$pd2, health$gender)
ELDbG
prop.table(ELDbG, 2)
```

####Chi-Squared 

We get a warning that the approximation may be incorrect, likely because some of the values from the table are small.  However, it potentially indicates that that the differences between genders may not be statistically significant (or we do not have enough information)

```{r}
chisq.test(ELDbG)
```

####Visualization of Data

```{r}
#Create Visualization
t2 <- ggplot(health, aes(x = health$pd3))+geom_bar()+facet_wrap(health$gender ~ ., scales="free_y") + ggtitle("Perceived Difficulty of Asking for Leave by Gender") + xlab("Perceived Difficulty Level") + ylab("Count") 
t2
```
NOTE:  VE = Very Easy, SE = Somewhat Easy, N = Neutral (or Neither Easy nor Difficult), SH = Somewhat Hard, VH = Very Hard, DK = Don't Know.  

####Interpretation of Results 

Across all genders, the most common answer is "Somewhat Easy".  Interestingly, for women the second most common answer is "Somewhat Difficult", while for men the second most common answer is "Very Easy."  For those indicating their gender falls into another category, an equal amount indicated that they felt asking for leave was very hard or provided a neutral response ("neither easy or hard"). Across all genders there is a significant group of people indicating they find it somewhat to very hard to ask for leave. That being said, there are fewer women and those from other genders participating in this survey (compared to men), which may impact our results. Furthermore, the chi-squared test indicated that the approximation may be incorrect, likely because some of the values from the table are small.

###Answers by Age Group

```{r}
#Do the AgeGroup Variable
labs <- c(paste(seq(17, 74, by = 20), seq(37, 80, by = 20),
                sep = "-"))
health$AgeGroup <- cut(health$age, breaks = c(seq(17, 74, by = 20), Inf), labels = labs, right = FALSE)
```

```{r}
#Crosstab table
ELDbA <- table(health$pd2, health$AgeGroup)
ELDbA
#Proportions table
prop.table(ELDbA)
```

####Chi-Squared

```{r}
chisq.test(ELDbA)
```

We get a warning that the approximation may be incorrect, likely because some of the values from the table are small.  However, it potentially indicates that that the differences between age groups may not be statistically significant (or we do not have enough information)

####Visualization of Data

```{r}
#Create Visualization
t3 <- ggplot(health, aes(x = health$pd3))+geom_bar()+facet_wrap(health$AgeGroup ~ ., scales="free_y") + ggtitle("Perceived Difficulty of Asking for Leave by Age Group") + xlab("Perceived Difficulty Level") + ylab("Count") 
t3
```
NOTE:  VE = Very Easy, SE = Somewhat Easy, N = Neutral (or Neither Easy nor Difficult), SH = Somewhat Hard, VH = Very Hard, DK = Don't Know.  

####Interpretation of Results

The most common response for those in the 17-27 and 37-57 age ranges is that asking for leave for a mental health issue was "Somewhat Easy" and the second most common isthat asking for leave "Very Easy".  However, there is a significant number in both age groups who provided a neutral answer (e.g., neither easy or difficult) or indicated that they felt asking for leave was hard/very hard. That being said, there are few people who are 57-77 participating in this survey and there are fewer people in the 37-57 age group than the 17-27 age group. Furthermore, the chi-squared test indicated that the approximation may be incorrect, likely because some of the values from the table are small (since few people fell into the 57-77 age range).  

###Answers by Company Size

```{r}
#Crosstab table
ELDbCS <- table(health$pd2, health$CompanySize)
ELDbCS
prop.table(ELDbCS, 2)
```

####Chi-Squared

```{r}
chisq.test(ELDbCS)
```

Because the p value is less than .01 we can reject the null and say that we think that there is a relationship between these two variables.

####Visualization of Data

```{r}
#Create Visualization
t4 <- ggplot(health, aes(x = health$pd3))+geom_bar()+facet_wrap(health$CompanySize~ ., scales="free_y") + ggtitle("Perceived Difficulty of Asking for Leave by Company Size") + xlab("Perceived Difficulty Level") + ylab("Count")
t4
```

NOTE:  VE = Very Easy, SE = Somewhat Easy, N = Neutral (or Neither Easy nor Difficult), SH = Somewhat Hard, VH = Very Hard, DK = Don't Know.  

####Interpretation of Results

For very small companies (1-5 employees), there seems to be a fairly even split between those who perceive taking leave for mental health to be easy and those who perceive it to be hard.  For other small companies (6-25 employees), approximately the same number of people say that it is easy/somewhat easy or provide a neutral response.  However, in this case, the most common answer is that they would perceive it as somehwat hard to ask for leave. For larger companies, the most common answer is that they perceive it to be somewhat easy to request leave for a mental illness.  Therefore it appears that as the company size gets larger, it may be perceived as easier in most companies to request leave related to a mental illness. However, there is still sizable minority of employees who work for larger companies (over 25 employees) who do perceive it as hard or very hard to ask for leave. Therefore, a lot may vary by the company.    

###Answers by Whether Current Company Provides Mental Health Benefits

```{r}
#Modify Labels for mental health benefit provision
health$mhb2 <- factor(health$Does.your.employer.provide.mental.health.benefits.as.part.of.healthcare.coverage.,
levels = c("I don't know", "No", "Not eligible for coverage / N/A","Yes"),
labels = c("Don't Know", "No", "Ineligible/NA", "Yes"))
```

```{r}
#Crosstab Table
ELDbMHB <- table(health$pd2, health$mhb2)
ELDbMHB
```

####Chi-Squared

```{r}
chisq.test(ELDbMHB)
```

Because the p value is not less than .01 we cannot reject the null. The null variables is that there is no relationship between these two variables.

####Create Visualization

```{r}
t5 <- ggplot(health, aes(x = health$pd3))+geom_bar()+facet_wrap(~ health$mhb2, scales="free_y") + ggtitle("Perceived Difficulty of Asking for Leave by MH Benefit Provision") + xlab("Perceived Difficulty Level") + ylab("Count")
t5
```
NOTE:  VE = Very Easy, SE = Somewhat Easy, N = Neutral (or Neither Easy nor Difficult), SH = Somewhat Hard, VH = Very Hard, DK = Don't Know.  

####Interpretation of Results

For those who do not get mental health benefits, more participants responded that they perceive it as somewhat difficult to request leave for a mental health issue than any other response (with somewhat easy being the second most common).  Among those who do get mental health benefits, most indicated they perceive it as very easy or somwhat easy to request leave for a mental health issue. Most of those who did not know if mental health benefits are offered inidicated they perceived it to be somewhat easy to request leave for a mental health issue. Those who are ineligible (or for whom it was not applicable) were evently split among the responses, although relatively few people selected this response compared to the others. However, the difference between the two variables does not appear to be statistically significant.  

###Answers by Whether Current Company Has Ever Formally Discussed Mental Health

```{r}
ELDbEDM <- table(health$pd2, health$Has.your.employer.ever.formally.discussed.mental.health..for.example..as.part.of.a.wellness.campaign.or.other.official.communication..)
ELDbEDM
```

####Chi-Squared

```{r}
chisq.test(ELDbEDM)
```

Because the p value is less than .01 we can reject the null and say that we think that there is a relationship between these two variables.

####Create Visualization

```{r}
t6 <- ggplot(health, aes(x = health$pd3))+geom_bar()+facet_wrap( health$Has.your.employer.ever.formally.discussed.mental.health..for.example..as.part.of.a.wellness.campaign.or.other.official.communication.. ~., scales="free_y") + ggtitle("Perceived Difficulty of Asking for Leave by MH Discussion by Employer") + xlab("Perceived Difficulty Level") + ylab("Count")
t6
```
NOTE:  VE = Very Easy, SE = Somewhat Easy, N = Neutral (or Neither Easy nor Difficult), SH = Somewhat Hard, VH = Very Hard, DK = Don't Know.  

####Interpretation of Results

Across all categories (e.g., yes they have discussed, no they haven't, don't know), the most common response is that most recipients think it would be somewhat easy to request leave. Interestingly, for those who did not know if there has been a discussion, a large contingent also indicated they don't know how hard it would be to request leave.  For those where there has been a discussion, far fewer people say it would be hard to request leave to handle a mental illness than those who say it would be easy to very easy. For those where there has not been a discussion (which is the majority of respondents), the second most common answer is that it would be somewhat hard to request leave to hanlde a mental illness.  

###Answers by Whether Current Company Offers Other Resources

```{r}
ELDbEOR <- table(health$pd2, health$Does.your.employer.offer.resources.to.learn.more.about.mental.health.concerns.and.options.for.seeking.help.)
ELDbEOR
```

####Chi-Squared 

Because the p value is less than .01 we can reject the null and say that we think that there are differences between categories.

```{r}
chisq.test(ELDbEOR)
```

####Create Visualization

```{r}
t7 <- ggplot(health, aes(x = health$pd3))+geom_bar()+facet_wrap( health$Does.your.employer.offer.resources.to.learn.more.about.mental.health.concerns.and.options.for.seeking.help. ~., scales="free_y") + ggtitle("Perceived Difficulty of Asking for Leave by Mental Health Resource Provision") + xlab("Perceived Difficulty Level") + ylab("Count")
t7
```
NOTE:  VE = Very Easy, SE = Somewhat Easy, N = Neutral (or Neither Easy nor Difficult), SH = Somewhat Hard, VH = Very Hard, DK = Don't Know.  

####Interpretation of Results

Across all categories (e.g., yes there are resources, no they aren't, don't know), the most common response is that most recipients think it would be somewhat easy to request leave. Similarly to the results provided above, in companies where there are other resources provided, fewer people say it would be hard to request leave to handle a mental illness than those who say it would be easy to very easy. For those where there are not additional resources offered related to mental health (the majority of respondents), the second most common answer is that it would be somewhat hard to request leave to hanlde a mental illness. 

###Answers by If They Ever Saw A Poor Response to Mental Health Issue

```{r}
ELDbPR <- table(health$pd2, health$Have.you.observed.or.experienced.an.unsupportive.or.badly.handled.response.to.a.mental.health.issue.in.your.current.or.previous.workplace.)
ELDbPR
prop.table(ELDbPR, 2)
```

#Revise Labels

```{r}
#Modify Labels for unsupportive response to make them shorter
health$epr <- factor(health$Have.you.observed.or.experienced.an.unsupportive.or.badly.handled.response.to.a.mental.health.issue.in.your.current.or.previous.workplace.,
levels = c("Maybe/Not sure", "N/A", "No","Yes, I experienced", "Yes, I observed"),
labels = c("Don't Know", "N/A", "No", "Yes, experienced", "Yes, observed"))
table(health$pd2, health$epr)
```

####Chi-Squared

```{r}
chisq.test(ELDbPR)
```

Because the p value is less than .01 we can reject the null and say that we think that there are differences between categories.

####Create Visualization

```{r}
t8 <- ggplot(health, aes(x = health$pd3))+geom_bar()+facet_wrap(health$epr ~., scales="free_y") + ggtitle("Perceived Difficulty of Asking for Leave by Exp. with Poor MH Response") + xlab("Perceived Difficulty Level") + ylab("Count")
t8
```
NOTE:  E = Very Easy, S = Somewhat Easy, N = Neutral (or Neither Easy nor Difficult), SH = Somewhat Hard, H = Very Hard, D = Don't Know.  

####Interpretation of Results

Most people surveyed indicate that they have never had an experience with an unsupportive or badly handled response to mental health in the workplace.  Among those who selected this response, the vast majority indicate they think that it would be very or somewhat easy to request leave to handle a mental illness.  For those who have observed a badly handled response, the most common response is that they would find it somewhat easy to request leave, but the second most common is that it they would find it somewhat difficult.  For those who have experienced a poorly handled response, the most common response is that they would find it somewhat easy to request leave, but a significant amount said they would find it hard or very hard to request leave (or provided a neutral response saying it would be neither easy or difficult). Therefore, it is possible that experience with a poorly handled response may have an impact on perceived ease of requesting leave.  

##Comfort with talking to Supervisor About Mental Health

This is important because if an employee has a mental health issue, they should ideally be comfortable discussing it with a supervisor in case they need additional assistance. In addition, we may want to consider training supervisors on how to handle instances where employees reach out to them about mental health. 

###Answers by Gender

```{r}
MHbG <- table(health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.., health$gender)
MHbG
prop.table(MHbG, 2)
```

####Chi-Squared

```{r}
chisq.test(MHbG)
```

The p value is very large.  Therefore, we cannot reject the null hypothesis. The null hypothesis is that these two variables are indepdendent (no relationship between them)

####Create Visualization

```{r}
t9 <- ggplot(health, aes(x = health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..))+geom_bar()+facet_grid(~ health$gender) + ggtitle("Comfort with Discussing MH with Supervisor by Gender") + xlab("Would you feel comfortable discussing a mental health disorder with your supervisor?") + ylab("Count")
t9
```

####Interpretation of Results

Most respondents across genders indicate that they would be comfortable discussing a mental health disorder with their supervisors. With male employees, a lower proportion indicate that they would not be comfortable discussing a mental health disorder with their supervisors. Meanwhile, with female and employees of other genders, the results are slightly more evenly split among the three options.  However, the difference is not statistically significant. 

###Answers by Age Group

```{r}
MHbA <- table(health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.., health$AgeGroup)
MHbA
prop.table(MHbA, 2)
```

####Chi-Squared

```{r}
chisq.test(MHbA)
```

We get a warning that the approximation may be incorrect, likely because some of the values from the table are small.  However, it potentially indicates that that the differences between age groups may not be statistically significant (or we do not have enough information).

####Create Visualization

```{r}
t10 <- ggplot(health, aes(x = health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..))+geom_bar()+facet_wrap(health$AgeGroup ~., scales="free_y") + ggtitle("Comfort with Discussing MH with Supervisor by Age") + xlab("Would you feel comfortable discussing a mental health disorder with your supervisor?") + ylab("Count")
t10
```

####Interpretation of Results

Survey respondents in the 17-37 and 37-57 age groups are about evenly split among stating they would feel comfortable discussing a mental health disorder with their supervisor, those who say they would not, and those who say they might. In both cases, the majority say they would feel comfortable.  The next most common response is maybe, and no received the least amount of responses. However, in both cases over a quarter of participants in both age groups answered that they would not feel comfortable.  The 57-77 range has a low number of responses, although in that case "No" is the second most common reponse.  Given the chi-squared test results and the visualization, it does not appear that age has much of an impact on comfort level in discussing a mental health disorder with a supervisor. However, the fact that there are fewer responses from the 37-57 and especially the 57-77 age groups may impact our results. 

###Answers by Company Size
```{r}
MHbCS <- table(health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.., health$CompanySize)
MHbCS
```

####Chi-Squared
```{r}
chisq.test(MHbCS)
```

###Answers by If They Ever Saw A Poor Response to Mental Health Issue

```{r}
MHbPR <- table(health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.., health$Have.you.observed.or.experienced.an.unsupportive.or.badly.handled.response.to.a.mental.health.issue.in.your.current.or.previous.workplace.)
MHbPR
```

####Chi-Squared

```{r}
chisq.test(MHbPR)
```

###Answers by If They Think Supervisor Would View Them Negatively If They Knew You Suffered From a Mental Health Issue

```{r}

```

##Comfort with taking to Coworkers About Mental Health

This is important because if an employee has a mental health issue, they should ideally be comfortable discussing it with a coworkers in case they need additional assistance. In addition, we may want to consider training employees on how to handle instances where coworkers reach out to them about mental health. 

###Answers by Gender

```{r}
MHCbG <- table(health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.coworkers., health$gender)
MHCbG
```

####Chi-Squared

```{r}
chisq.test(MHCbG)
```

###Answers by Age Group

```{r}
MHCbA <- table(health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.coworkers., health$AgeGroup)
MHCbA
#Proportions (as column percentages)
prop.table(MHCbA, 2)
```

####Chi-Squared 

```{r}
#Chi-Squared (We get a big chi-quared and a warning it may be incorrect, likely b/c small values for the 57-77 column)
chisq.test(MHCbA)
```

###Answers by Company Size

```{r}
MHCbCS <- table(health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.coworkers., health$CompanySize)
MHCbCS
#Proportions (as column percentages)
prop.table(MHCbCS, 2)
```

####Chi-Squared

```{r}
#Chi-Squared (the p value is small)
chisq.test(MHCbCS)
```

###Answers by If They Ever Saw A Poor Response to Mental Health Issue

```{r}
MHCbPR <- table(health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.coworkers., health$Have.you.observed.or.experienced.an.unsupportive.or.badly.handled.response.to.a.mental.health.issue.in.your.current.or.previous.workplace.)
MHCbPR
```

####Chi-Squared

```{r}
chisq.test(MHCbPR)
```

###Answers by If They Think Coworkers Would View Them Negatively If They Knew You Suffered From a Mental Health Issue

```{r}
MHCbCN <- table(health$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.coworkers., health$Do.you.think.that.team.members.co.workers.would.view.you.more.negatively.if.they.knew.you.suffered.from.a.mental.health.issue.)
MHCbCN
```

####Chi-Squared
```{r}
chisq.test(MHCbCN)
```

#Works Cited

Milne, S. H., Blum, T. C., & Roman, P. M. (1994). Factors Influencing Employees’ Propensity to Use an Employee Assistance Program. Personnel Psychology, 47(1), 123–145. Retrieved October 24, 2018 from http://search.ebscohost.com.proxy-um.researchport.umd.edu/login.aspx?direct=true&db=bth&AN=9411113184&site=ehost-live